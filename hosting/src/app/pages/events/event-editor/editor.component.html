<mat-horizontal-stepper>
  <mat-step [stepControl]="contentFormGroup" errorMessage="Inhalt unvollständig.">
    <form [formGroup]="contentFormGroup">
      <ng-template matStepLabel>Inhalt</ng-template>
      <mat-form-field>
        <mat-label>Titel</mat-label>
        <input matInput formControlName="title" />
        <mat-error *ngIf="contentFormGroup.controls.title.invalid">
          {{ contentFormGroup.controls.title | errorMessage }}
        </mat-error>
      </mat-form-field>
      <mat-form-field>
        <mat-chip-list #chipList aria-label="tag Auswahl" formControlName="tags">
          <mat-chip
            *ngFor="let tag of contentFormGroup.get('tags').value"
            (removed)="chips.removeItem(tag, contentFormGroup.get('tags'))"
          >
            {{ tag }}
            <mat-icon matChipRemove>cancel</mat-icon>
          </mat-chip>
          <input
            placeholder="Tags"
            [matChipInputFor]="chipList"
            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            (matChipInputTokenEnd)="chips.addItem($event, eventForm.get('tags'))"
          />
        </mat-chip-list>
      </mat-form-field>
      <mat-tab-group>
        <mat-tab label="Bearbeiten">
          <mat-form-field class="description">
            <mat-label>Beschreibung</mat-label>
            <textarea matInput [rows]="10" formControlName="description"></textarea>
          </mat-form-field>
        </mat-tab>
        <mat-tab label="Vorschau">
          <app-markdown-preview [markdownText]="contentFormGroup.get('description').value"></app-markdown-preview>
        </mat-tab>
      </mat-tab-group>
    </form>
  </mat-step>
  <mat-step [stepControl]="dateFormGroup" errorMessage="Datum fehlerhaft.">
    <form [formGroup]="dateFormGroup">
      <ng-template matStepLabel>Datum</ng-template>
      <mat-form-field class="date-time">
        <mat-label>Datum</mat-label>
        <input matInput placeholder="DD.MM.YYYY" [matDatepicker]="picker1" formControlName="date" />
        <mat-error *ngIf="dateFormGroup.controls.date.invalid"> {{ dateFormGroup.controls.date | errorMessage }} </mat-error>
        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
        <mat-datepicker #picker1></mat-datepicker>
      </mat-form-field>

      <mat-form-field class="date-time">
        <mat-label>Zeit</mat-label>
        <input matInput placeholder="HH:MM" formControlName="time" />
        <mat-error *ngIf="dateFormGroup.controls.time.invalid"> {{ dateFormGroup.controls.time | errorMessage }} </mat-error>
      </mat-form-field>
    </form>
  </mat-step>
  <mat-step [stepControl]="participantsFormGroup" errorMessage="Teilnehmer/Deadline fehlerhaft.">
    <form [formGroup]="participantsFormGroup">
      <ng-template matStepLabel>Teilnehmer</ng-template>
      <mat-form-field class="date-time">
        <mat-label>Deadline-Datum</mat-label>
        <input placeholder="DD.MM.YYYY" matInput [matDatepicker]="picker3" formControlName="deadlineDate" />
        <mat-error *ngIf="this.participantsFormGroup.get('deadlineDate').invalid">
          {{ this.participantsFormGroup.get('deadlineDate') | errorMessage }}
        </mat-error>
        <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
        <mat-datepicker #picker3></mat-datepicker>
      </mat-form-field>

      <mat-form-field class="date-time">
        <mat-label>Deadline-Zeit</mat-label>
        <input matInput placeholder="HH:MM" formControlName="deadlineTime" />
        <mat-error *ngIf="this.participantsFormGroup.get('deadlineTime').invalid">
          {{ this.participantsFormGroup.get('deadlineTime') | errorMessage }}
        </mat-error>
      </mat-form-field>

      <mat-chip-list>
        <mat-chip
          *ngFor="let group of groups"
          [color]="'accent'"
          [selected]="true"
          (click)="onAddGroup(group)"
          (removed)="onRemoveGroup(group)"
        >
          {{ group }}
          <mat-icon matChipRemove>cancel</mat-icon>
        </mat-chip>
      </mat-chip-list>

      <mat-form-field>
        <mat-chip-list [selectable]="true" [multiple]="true" formControlName="participants">
          <mat-chip
            #chips
            *ngFor="let person of persons"
            [color]="'primary'"
            (click)="onPersonClick(person.id)"
            [selected]="isPersonSelected(person.id)"
            [class.mat-chip-selected]="isPersonSelected(person.id)"
          >
            {{ person.name }}
          </mat-chip>
        </mat-chip-list>
        <mat-error *ngIf="this.participantsFormGroup.get('participants').invalid">
          {{ this.participantsFormGroup.get('participants') | errorMessage }}
        </mat-error>
      </mat-form-field>
    </form>
  </mat-step>
</mat-horizontal-stepper>

<!-- <ng-container *ngIf="event && eventForm && persons">
  <mat-toolbar [color]="'accent'">
    <div>Event Bearbeiten</div>
    <div class="spacer"></div>
    <a mat-icon-button [routerLink]="'/events/overview'"><mat-icon>apps</mat-icon></a>
  </mat-toolbar>
  <form [formGroup]="eventForm" (ngSubmit)="onSubmit()">





    <mat-expansion-panel formGroupName="deadline" [style.grid-area]="'deadline'">
      <mat-expansion-panel-header>
        <mat-panel-title>Teilnehmer</mat-panel-title>
        <mat-panel-description>{{
          this.eventForm.get('deadline').invalid
            ? (this.eventForm.get('deadline') | errorMessage)
            : 'Teilnehmer einladen und Deadline festlegen'
        }}</mat-panel-description>
      </mat-expansion-panel-header>

    </mat-expansion-panel>
    <button
      *ngIf="!eventForm.disabled; else saveSpinner"
      mat-raised-button
      type="submit"
      [color]="'primary'"
      [style.grid-area]="'save'"
      [disabled]="eventForm.invalid || !eventForm.dirty"
    >
      <mat-icon>save</mat-icon> SPEICHERN
    </button>
    <ng-template #saveSpinner>
      <mat-spinner [style.grid-area]="'save'" [color]="'accent'" [diameter]="36"></mat-spinner>
    </ng-template>
    <button
      mat-raised-button
      type="button"
      [color]="'warn'"
      [style.grid-area]="'delete'"
      [disabled]="!event.id"
      (click)="deleteEvent()"
    >
      <mat-icon>delete</mat-icon> LÖSCHEN
    </button>
  </form>
</ng-container> -->
